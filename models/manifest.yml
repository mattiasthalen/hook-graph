concepts:

  - name: part
    description: A part in the product catalog (PART).

  - name: supplier
    description: A supplier company (SUPPLIER).

  - name: customer
    description: A customer account (CUSTOMER).

  - name: order
    description: Sales order header (ORDERS).

  - name: line
    description: Sales order line item (LINEITEM).

  - name: partsupp
    description: Supplier's offer for a specific part (PARTSUPP).

  - name: nation
    description: Nation for geo segmentation (NATION).

  - name: region
    description: Region for geo segmentation (REGION).

keysets:

  - name: tpch:part:partkey
    concept: part
    source_system: tpch
    description: Native PART identifier from PART.PARTKEY

  - name: tpch:supplier:suppkey
    concept: supplier
    source_system: tpch
    description: Native SUPPLIER identifier from SUPPLIER.SUPPKEY

  - name: tpch:customer:custkey
    concept: customer
    source_system: tpch
    description: Native CUSTOMER identifier from CUSTOMER.CUSTKEY

  - name: tpch:order:orderkey
    concept: order
    source_system: tpch
    description: Native ORDERS identifier from ORDERS.ORDERKEY

  - name: tpch:line:orderkey:linenumber
    concept: line
    source_system: tpch
    description: Composed LINEITEM identifier from (ORDERKEY, LINENUMBER)

  - name: tpch:partsupp:partkey:suppkey
    concept: partsupp
    source_system: tpch
    description: Composed PARTSUPP identifier from (PARTKEY, SUPPKEY)

  - name: tpch:nation:nationkey
    concept: nation
    source_system: tpch
    description: Native NATION identifier from NATION.NATIONKEY

  - name: tpch:region:regionkey
    concept: region
    source_system: tpch
    description: Native REGION identifier from REGION.REGIONKEY

frames:

  - name: part
    source_table: raw.tpch__part
    grain: [PARTKEY]
    description: Catalog of parts.
    hooks:

      - name: hook__part
        concept: part
        keyset: tpch:part:partkey
        business_key_field: PARTKEY

  - name: supplier
    source_table: raw.tpch__supplier
    grain: [SUPPKEY]
    description: Supplier master data.
    hooks:

      - name: hook__supplier
        concept: supplier
        keyset: tpch:supplier:suppkey
        business_key_field: SUPPKEY

      - name: hook__nation
        concept: nation
        keyset: tpch:nation:nationkey
        business_key_field: NATIONKEY

  - name: customer
    source_table: raw.tpch__customer
    grain: [CUSTKEY]
    description: Customer master data.
    hooks:

      - name: hook__customer
        concept: customer
        keyset: tpch:customer:custkey
        business_key_field: CUSTKEY

      - name: hook__nation
        concept: nation
        keyset: tpch:nation:nationkey
        business_key_field: NATIONKEY

  - name: orders
    source_table: raw.tpch__orders
    grain: [ORDERKEY]
    description: Orders header.
    hooks:

      - name: hook__order
        concept: order
        keyset: tpch:order:orderkey
        business_key_field: ORDERKEY

      - name: hook__customer
        concept: customer
        keyset: tpch:customer:custkey
        business_key_field: CUSTKEY

  - name: lineitem
    source_table: raw.tpch__lineitem
    grain: [ORDERKEY, LINENUMBER]
    description: Order line facts.
    hooks:

      - name: hook__line
        concept: line
        keyset: tpch:line:orderkey:linenumber
        business_key_field: concat_ws('|', ORDERKEY::TEXT, LINENUMBER::TEXT)

      - name: hook__order
        concept: order
        keyset: tpch:order:orderkey
        business_key_field: ORDERKEY

      - name: hook__part
        concept: part
        keyset: tpch:part:partkey
        business_key_field: PARTKEY

      - name: hook__supplier
        concept: supplier
        keyset: tpch:supplier:suppkey
        business_key_field: SUPPKEY

  - name: partsupp
    source_table: raw.tpch__partsupp
    grain: [PARTKEY, SUPPKEY]
    description: Supplier-part offers with costs and availability.
    hooks:

      - name: hook__partsupp
        concept: partsupp
        keyset: tpch:partsupp:partkey:suppkey
        business_key_field: concat_ws('|', PARTKEY::TEXT, SUPPKEY::TEXT)

      - name: hook__part
        concept: part
        keyset: tpch:part:partkey
        business_key_field: PARTKEY

      - name: hook__supplier
        concept: supplier
        keyset: tpch:supplier:suppkey
        business_key_field: SUPPKEY

  - name: nation
    source_table: raw.tpch__nation
    grain: [NATIONKEY]
    description: Nation dimension.
    hooks:

      - name: hook__nation
        concept: nation
        keyset: tpch:nation:nationkey
        business_key_field: NATIONKEY

      - name: hook__region
        concept: region
        keyset: tpch:region:regionkey
        business_key_field: REGIONKEY

  - name: region
    source_table: raw.tpch__region
    grain: [REGIONKEY]
    description: Region dimension.
    hooks:

      - name: hook__region
        concept: region
        keyset: tpch:region:regionkey
        business_key_field: REGIONKEY
